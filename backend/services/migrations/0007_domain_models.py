# Generated by Django 6.0.2 on 2026-02-23 04:55

import django.core.validators
import django.db.models.deletion
import services.domain_models
import uuid
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('services', '0006_billingaccount_invoice_creditnote_invoicelineitem_and_more'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.AlterField(
            model_name='monitoringalert',
            name='owner',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='monitoring_alerts', to=settings.AUTH_USER_MODEL),
        ),
        migrations.CreateModel(
            name='Campaign',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('resource_id', models.CharField(db_index=True, editable=False, max_length=64, unique=True)),
                ('name', models.CharField(db_index=True, max_length=255)),
                ('description', models.TextField(blank=True, null=True)),
                ('tags', models.JSONField(default=dict, help_text='Key-value tags for resource')),
                ('metadata', models.JSONField(default=dict, help_text='Additional metadata')),
                ('status', models.CharField(choices=[('draft', 'Draft'), ('scheduled', 'Scheduled'), ('sending', 'Sending'), ('sent', 'Sent'), ('paused', 'Paused'), ('cancelled', 'Cancelled'), ('error', 'Error')], default='draft', max_length=20)),
                ('campaign_type', models.CharField(choices=[('regular', 'Regular'), ('ab_test', 'A/B Test'), ('automated', 'Automated'), ('rss', 'RSS Campaign')], default='regular', max_length=20)),
                ('from_name', models.CharField(max_length=100)),
                ('from_email', models.EmailField(max_length=254)),
                ('reply_to', models.EmailField(blank=True, max_length=254)),
                ('subject', models.CharField(max_length=255)),
                ('preview_text', models.CharField(blank=True, max_length=255)),
                ('html_body', models.TextField(blank=True)),
                ('text_body', models.TextField(blank=True)),
                ('scheduled_at', models.DateTimeField(blank=True, null=True)),
                ('sent_at', models.DateTimeField(blank=True, null=True)),
                ('track_opens', models.BooleanField(default=True)),
                ('track_clicks', models.BooleanField(default=True)),
                ('google_analytics', models.BooleanField(default=False)),
                ('utm_source', models.CharField(blank=True, max_length=100)),
                ('utm_medium', models.CharField(blank=True, default='email', max_length=100)),
                ('utm_campaign', models.CharField(blank=True, max_length=100)),
                ('owner', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(class)s_owned', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Campaign',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='CampaignAnalytics',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('total_sent', models.PositiveIntegerField(default=0)),
                ('delivered', models.PositiveIntegerField(default=0)),
                ('bounced', models.PositiveIntegerField(default=0)),
                ('hard_bounces', models.PositiveIntegerField(default=0)),
                ('soft_bounces', models.PositiveIntegerField(default=0)),
                ('opens', models.PositiveIntegerField(default=0)),
                ('unique_opens', models.PositiveIntegerField(default=0)),
                ('clicks', models.PositiveIntegerField(default=0)),
                ('unique_clicks', models.PositiveIntegerField(default=0)),
                ('unsubscribes', models.PositiveIntegerField(default=0)),
                ('complaints', models.PositiveIntegerField(default=0)),
                ('link_clicks', models.JSONField(default=dict, help_text='url → click count')),
                ('last_synced_at', models.DateTimeField(blank=True, null=True)),
                ('campaign', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='analytics', to='services.campaign')),
            ],
            options={
                'verbose_name_plural': 'Campaign Analytics',
            },
        ),
        migrations.CreateModel(
            name='ContactList',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('resource_id', models.CharField(db_index=True, editable=False, max_length=64, unique=True)),
                ('name', models.CharField(db_index=True, max_length=255)),
                ('tags', models.JSONField(default=dict, help_text='Key-value tags for resource')),
                ('metadata', models.JSONField(default=dict, help_text='Additional metadata')),
                ('status', models.CharField(choices=[('active', 'Active'), ('archived', 'Archived')], default='active', max_length=20)),
                ('description', models.TextField(blank=True)),
                ('double_optin', models.BooleanField(default=False, help_text='Require email confirmation on subscribe')),
                ('owner', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(class)s_owned', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Contact List',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='Contact',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('email', models.EmailField(db_index=True, max_length=254)),
                ('first_name', models.CharField(blank=True, max_length=100)),
                ('last_name', models.CharField(blank=True, max_length=100)),
                ('status', models.CharField(choices=[('subscribed', 'Subscribed'), ('unsubscribed', 'Unsubscribed'), ('bounced', 'Bounced'), ('complained', 'Complained'), ('pending', 'Pending Confirmation')], default='subscribed', max_length=20)),
                ('custom_fields', models.JSONField(default=dict, help_text='Extra fields: company, phone, etc.')),
                ('subscribed_at', models.DateTimeField(auto_now_add=True)),
                ('unsubscribed_at', models.DateTimeField(blank=True, null=True)),
                ('ip_address', models.GenericIPAddressField(blank=True, null=True)),
                ('tags', models.JSONField(default=list)),
                ('contact_list', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='contacts', to='services.contactlist')),
            ],
            options={
                'ordering': ['-created_at'],
                'unique_together': {('contact_list', 'email')},
            },
        ),
        migrations.AddField(
            model_name='campaign',
            name='contact_lists',
            field=models.ManyToManyField(blank=True, related_name='campaigns', to='services.contactlist'),
        ),
        migrations.CreateModel(
            name='Automation',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('resource_id', models.CharField(db_index=True, editable=False, max_length=64, unique=True)),
                ('name', models.CharField(db_index=True, max_length=255)),
                ('description', models.TextField(blank=True, null=True)),
                ('tags', models.JSONField(default=dict, help_text='Key-value tags for resource')),
                ('metadata', models.JSONField(default=dict, help_text='Additional metadata')),
                ('trigger', models.CharField(choices=[('subscribe', 'On Subscribe'), ('unsubscribe', 'On Unsubscribe'), ('date_field', 'On Date Field'), ('campaign_open', 'On Campaign Open'), ('campaign_click', 'On Campaign Click'), ('manual', 'Manual Trigger')], default='subscribe', max_length=30)),
                ('is_active', models.BooleanField(default=False)),
                ('steps', models.JSONField(default=list, help_text='Ordered list of steps: [{delay_days, subject, html_body, from_email}]')),
                ('owner', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(class)s_owned', to=settings.AUTH_USER_MODEL)),
                ('contact_list', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='automations', to='services.contactlist')),
            ],
            options={
                'verbose_name': 'Automation',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='Domain',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('resource_id', models.CharField(db_index=True, editable=False, max_length=64, unique=True)),
                ('name', models.CharField(db_index=True, max_length=255)),
                ('description', models.TextField(blank=True, null=True)),
                ('tags', models.JSONField(default=dict, help_text='Key-value tags for resource')),
                ('metadata', models.JSONField(default=dict, help_text='Additional metadata')),
                ('domain_name', models.CharField(db_index=True, max_length=253, unique=True)),
                ('tld', models.CharField(max_length=20)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('active', 'Active'), ('expired', 'Expired'), ('suspended', 'Suspended'), ('transferring', 'Transferring'), ('deleting', 'Deleting'), ('error', 'Error')], db_index=True, default='pending', max_length=20)),
                ('reseller_order_id', models.CharField(blank=True, max_length=64)),
                ('reseller_customer_id', models.CharField(blank=True, max_length=64)),
                ('registered_at', models.DateTimeField(blank=True, null=True)),
                ('expires_at', models.DateTimeField(blank=True, db_index=True, null=True)),
                ('auto_renew', models.BooleanField(default=True)),
                ('registration_years', models.PositiveSmallIntegerField(default=1)),
                ('whois_privacy', models.BooleanField(default=True)),
                ('dnssec_enabled', models.BooleanField(default=False)),
                ('nameservers', models.JSONField(default=list)),
                ('registrant_contact', models.JSONField(default=dict)),
                ('admin_contact', models.JSONField(default=dict)),
                ('tech_contact', models.JSONField(default=dict)),
                ('linked_compute_id', models.CharField(blank=True, max_length=64)),
                ('linked_storage_bucket', models.CharField(blank=True, max_length=128)),
                ('owner', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(class)s_owned', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='DnsZone',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('zone_id', models.CharField(db_index=True, max_length=64, unique=True)),
                ('zone_name', models.CharField(max_length=255)),
                ('status', models.CharField(choices=[('active', 'Active'), ('pending', 'Pending'), ('error', 'Error'), ('deleted', 'Deleted')], default='pending', max_length=20)),
                ('email', models.EmailField(default='hostmaster@atonixcorp.com', max_length=254)),
                ('ttl', models.PositiveIntegerField(default=300)),
                ('serial', models.BigIntegerField(default=1)),
                ('description', models.TextField(blank=True)),
                ('domain', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='dns_zone', to='services.domain')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='DomainDnsRecord',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('recordset_id', models.CharField(blank=True, db_index=True, max_length=64)),
                ('name', models.CharField(max_length=255)),
                ('record_type', models.CharField(choices=[('A', 'A'), ('AAAA', 'AAAA'), ('CNAME', 'CNAME'), ('MX', 'MX'), ('TXT', 'TXT'), ('NS', 'NS'), ('SOA', 'SOA'), ('SRV', 'SRV'), ('CAA', 'CAA'), ('PTR', 'PTR')], max_length=10)),
                ('records', models.JSONField(default=list)),
                ('ttl', models.PositiveIntegerField(default=300)),
                ('description', models.TextField(blank=True)),
                ('is_managed', models.BooleanField(default=False, help_text='Auto-managed by platform')),
                ('zone', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='records', to='services.dnszone')),
            ],
            options={
                'db_table': 'services_domainrecord',
                'ordering': ['record_type', 'name'],
            },
        ),
        migrations.CreateModel(
            name='DomainTransfer',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('status', models.CharField(choices=[('initiated', 'Initiated'), ('pending', 'Pending Auth'), ('approved', 'Approved'), ('rejected', 'Rejected'), ('completed', 'Completed'), ('failed', 'Failed')], default='initiated', max_length=20)),
                ('reseller_order_id', models.CharField(blank=True, max_length=64)),
                ('epp_code', models.CharField(blank=True, max_length=128)),
                ('initiated_at', models.DateTimeField(auto_now_add=True)),
                ('completed_at', models.DateTimeField(blank=True, null=True)),
                ('error_message', models.TextField(blank=True)),
                ('domain', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='transfers', to='services.domain')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='EmailDomain',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('status', models.CharField(choices=[('pending', 'Pending Verification'), ('active', 'Active'), ('disabled', 'Disabled'), ('error', 'Error')], default='pending', max_length=20)),
                ('mail_host', models.CharField(default='mail.atonixcorp.com', help_text='FQDN of the mail server', max_length=253)),
                ('smtp_port', models.PositiveIntegerField(default=587)),
                ('imap_port', models.PositiveIntegerField(default=993)),
                ('pop_port', models.PositiveIntegerField(default=995)),
                ('mx_provisioned', models.BooleanField(default=False)),
                ('spf_provisioned', models.BooleanField(default=False)),
                ('dkim_provisioned', models.BooleanField(default=False)),
                ('dmarc_provisioned', models.BooleanField(default=False)),
                ('webmail_url', models.URLField(blank=True)),
                ('default_quota_mb', models.PositiveIntegerField(default=5120)),
                ('domain', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='email_domain', to='services.domain')),
            ],
            options={
                'verbose_name': 'Email Domain',
            },
        ),
        migrations.CreateModel(
            name='EmailTemplate',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('resource_id', models.CharField(db_index=True, editable=False, max_length=64, unique=True)),
                ('name', models.CharField(db_index=True, max_length=255)),
                ('description', models.TextField(blank=True, null=True)),
                ('tags', models.JSONField(default=dict, help_text='Key-value tags for resource')),
                ('metadata', models.JSONField(default=dict, help_text='Additional metadata')),
                ('category', models.CharField(choices=[('newsletter', 'Newsletter'), ('promotional', 'Promotional'), ('transactional', 'Transactional'), ('welcome', 'Welcome'), ('announcement', 'Announcement'), ('custom', 'Custom')], default='newsletter', max_length=30)),
                ('subject', models.CharField(max_length=255)),
                ('preview_text', models.CharField(blank=True, help_text='Short preview shown in inbox', max_length=255)),
                ('html_body', models.TextField(help_text='Full HTML email body')),
                ('text_body', models.TextField(blank=True, help_text='Plain-text fallback')),
                ('thumbnail_url', models.URLField(blank=True)),
                ('is_active', models.BooleanField(default=True)),
                ('variables', models.JSONField(default=list, help_text='List of merge-tag variable names')),
                ('owner', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(class)s_owned', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Email Template',
                'ordering': ['-created_at'],
            },
        ),
        migrations.AddField(
            model_name='campaign',
            name='template',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='campaigns', to='services.emailtemplate'),
        ),
        migrations.CreateModel(
            name='Mailbox',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('resource_id', models.CharField(db_index=True, editable=False, max_length=64, unique=True)),
                ('name', models.CharField(db_index=True, max_length=255)),
                ('description', models.TextField(blank=True, null=True)),
                ('tags', models.JSONField(default=dict, help_text='Key-value tags for resource')),
                ('metadata', models.JSONField(default=dict, help_text='Additional metadata')),
                ('local_part', models.CharField(help_text='The part before @', max_length=64)),
                ('password_hash', models.CharField(blank=True, max_length=256)),
                ('status', models.CharField(choices=[('active', 'Active'), ('suspended', 'Suspended'), ('deleted', 'Deleted'), ('creating', 'Creating'), ('error', 'Error')], default='creating', max_length=20)),
                ('quota_mb', models.PositiveIntegerField(default=5120)),
                ('used_mb', models.PositiveIntegerField(default=0)),
                ('first_name', models.CharField(blank=True, max_length=100)),
                ('last_name', models.CharField(blank=True, max_length=100)),
                ('is_admin', models.BooleanField(default=False, help_text='Domain admin mailbox')),
                ('last_login', models.DateTimeField(blank=True, null=True)),
                ('forward_to', models.EmailField(blank=True, max_length=254)),
                ('keep_local_copy', models.BooleanField(default=True)),
                ('email_domain', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='mailboxes', to='services.emaildomain')),
                ('owner', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(class)s_owned', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Mailbox',
                'unique_together': {('email_domain', 'local_part')},
            },
        ),
        migrations.CreateModel(
            name='EmailActivityLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('event', models.CharField(choices=[('mailbox_created', 'Mailbox Created'), ('mailbox_deleted', 'Mailbox Deleted'), ('alias_created', 'Alias Created'), ('dns_provisioned', 'DNS Provisioned'), ('dkim_generated', 'DKIM Key Generated'), ('password_changed', 'Password Changed'), ('quota_updated', 'Quota Updated'), ('error', 'Error')], max_length=40)),
                ('detail', models.TextField(blank=True)),
                ('actor', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
                ('email_domain', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='activity_logs', to='services.emaildomain')),
                ('mailbox', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='activity_logs', to='services.mailbox')),
            ],
            options={
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='ManagedDatabase',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.CharField(db_index=True, max_length=255)),
                ('description', models.TextField(blank=True)),
                ('engine', models.CharField(choices=[('postgresql', 'PostgreSQL'), ('mysql', 'MySQL'), ('mariadb', 'MariaDB'), ('mongodb', 'MongoDB'), ('redis', 'Redis'), ('clickhouse', 'ClickHouse'), ('cassandra', 'Cassandra')], db_index=True, max_length=30)),
                ('version', models.CharField(max_length=20)),
                ('tenancy_model', models.CharField(choices=[('shared', 'Shared Cluster'), ('dedicated', 'Dedicated Instance'), ('cluster', 'Dedicated HA Cluster')], default='shared', max_length=20)),
                ('vcpus', models.IntegerField(default=1, validators=[django.core.validators.MinValueValidator(1)])),
                ('memory_mb', models.IntegerField(default=1024, validators=[django.core.validators.MinValueValidator(256)])),
                ('storage_gb', models.IntegerField(default=20, validators=[django.core.validators.MinValueValidator(1)])),
                ('read_replicas', models.IntegerField(default=0, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(5)])),
                ('region', models.CharField(choices=[('af-south-1', 'Africa — Johannesburg'), ('eu-west-1', 'Europe — Frankfurt'), ('ap-south-1', 'Asia — Singapore'), ('us-east-1', 'US East — New York'), ('us-west-1', 'US West — Los Angeles')], default='af-south-1', max_length=30)),
                ('status', models.CharField(choices=[('provisioning', 'Provisioning'), ('running', 'Running'), ('stopped', 'Stopped'), ('restarting', 'Restarting'), ('scaling', 'Scaling'), ('deleting', 'Deleting'), ('error', 'Error'), ('backup', 'Backup in Progress')], db_index=True, default='provisioning', max_length=20)),
                ('host', models.CharField(blank=True, max_length=255)),
                ('port', models.IntegerField(blank=True, null=True)),
                ('database_name', models.CharField(default='atonix', max_length=255)),
                ('connection_uri', models.TextField(blank=True, help_text='Masked connection string stored securely')),
                ('ssl_enabled', models.BooleanField(default=True)),
                ('publicly_accessible', models.BooleanField(default=False)),
                ('vpc_id', models.CharField(blank=True, max_length=64)),
                ('allowed_ips', models.JSONField(default=list, help_text='CIDR allowlist')),
                ('backup_enabled', models.BooleanField(default=True)),
                ('backup_retention_days', models.IntegerField(default=7, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(35)])),
                ('last_backup_at', models.DateTimeField(blank=True, null=True)),
                ('current_storage_gb', models.FloatField(default=0.0)),
                ('connection_count', models.IntegerField(default=0)),
                ('hourly_cost_usd', models.DecimalField(decimal_places=4, default=0.0, max_digits=8)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('provisioned_at', models.DateTimeField(blank=True, null=True)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('owner', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='databases', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='DatabaseMetric',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('cpu_percent', models.FloatField(blank=True, null=True)),
                ('memory_percent', models.FloatField(blank=True, null=True)),
                ('storage_used_gb', models.FloatField(blank=True, null=True)),
                ('active_connections', models.IntegerField(blank=True, null=True)),
                ('queries_per_second', models.FloatField(blank=True, null=True)),
                ('avg_query_latency_ms', models.FloatField(blank=True, null=True)),
                ('replication_lag_ms', models.FloatField(blank=True, null=True)),
                ('iops_read', models.IntegerField(blank=True, null=True)),
                ('iops_write', models.IntegerField(blank=True, null=True)),
                ('database', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='metrics', to='services.manageddatabase')),
            ],
            options={
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='DatabaseCredential',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('username', models.CharField(max_length=255)),
                ('password', models.CharField(help_text='Stored encrypted in production', max_length=512)),
                ('role', models.CharField(choices=[('admin', 'Admin'), ('readwrite', 'Read/Write'), ('readonly', 'Read Only')], default='admin', max_length=30)),
                ('is_active', models.BooleanField(default=True)),
                ('last_rotated_at', models.DateTimeField(blank=True, null=True)),
                ('database', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='credentials', to='services.manageddatabase')),
            ],
            options={
                'ordering': ['role'],
            },
        ),
        migrations.CreateModel(
            name='DatabaseBackup',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('backup_id', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('backup_type', models.CharField(choices=[('automated', 'Automated'), ('manual', 'Manual'), ('pitr', 'Point-in-Time')], default='automated', max_length=20)),
                ('status', models.CharField(choices=[('running', 'Running'), ('completed', 'Completed'), ('failed', 'Failed')], default='running', max_length=20)),
                ('size_gb', models.FloatField(default=0.0)),
                ('duration_s', models.IntegerField(default=0, help_text='Backup duration in seconds')),
                ('storage_path', models.CharField(blank=True, max_length=512)),
                ('expires_at', models.DateTimeField(blank=True, null=True)),
                ('database', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='backups', to='services.manageddatabase')),
            ],
            options={
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='SendEvent',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('event', models.CharField(choices=[('sent', 'Sent'), ('delivered', 'Delivered'), ('opened', 'Opened'), ('clicked', 'Clicked'), ('bounced', 'Bounced'), ('unsubscribed', 'Unsubscribed'), ('complained', 'Complained')], max_length=20)),
                ('metadata', models.JSONField(default=dict, help_text='url, user_agent, ip, etc.')),
                ('campaign', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='send_events', to='services.campaign')),
                ('contact', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='send_events', to='services.contact')),
            ],
            options={
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='SslCertificate',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('cert_id', models.CharField(default=services.domain_models._default_cert_id, max_length=64, unique=True)),
                ('common_name', models.CharField(max_length=253)),
                ('sans', models.JSONField(default=list, help_text='Subject Alternative Names')),
                ('issuer', models.CharField(default="Let's Encrypt", max_length=128)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('active', 'Active'), ('expired', 'Expired'), ('revoked', 'Revoked'), ('error', 'Error')], default='pending', max_length=20)),
                ('issued_at', models.DateTimeField(blank=True, null=True)),
                ('expires_at', models.DateTimeField(blank=True, null=True)),
                ('auto_renew', models.BooleanField(default=True)),
                ('cert_pem', models.TextField(blank=True)),
                ('chain_pem', models.TextField(blank=True)),
                ('domain', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='ssl_certs', to='services.domain')),
            ],
            options={
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='EmailAlias',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('local_part', models.CharField(max_length=64)),
                ('destinations', models.JSONField(default=list, help_text='List of destination email addresses')),
                ('is_active', models.BooleanField(default=True)),
                ('email_domain', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='aliases', to='services.emaildomain')),
            ],
            options={
                'verbose_name': 'Email Alias',
                'unique_together': {('email_domain', 'local_part')},
            },
        ),
        migrations.CreateModel(
            name='DkimKey',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('selector', models.CharField(default='default', max_length=64)),
                ('public_key', models.TextField(blank=True)),
                ('private_key', models.TextField(blank=True)),
                ('dns_record', models.TextField(blank=True, help_text='Full TXT record value for DNS')),
                ('is_active', models.BooleanField(default=True)),
                ('email_domain', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='dkim_keys', to='services.emaildomain')),
            ],
            options={
                'verbose_name': 'DKIM Key',
                'unique_together': {('email_domain', 'selector')},
            },
        ),
        migrations.AddIndex(
            model_name='manageddatabase',
            index=models.Index(fields=['owner', 'status'], name='services_ma_owner_i_bad671_idx'),
        ),
        migrations.AddIndex(
            model_name='manageddatabase',
            index=models.Index(fields=['engine', 'status'], name='services_ma_engine_6a68ce_idx'),
        ),
        migrations.AddIndex(
            model_name='manageddatabase',
            index=models.Index(fields=['region', 'status'], name='services_ma_region_4121e1_idx'),
        ),
        migrations.AddIndex(
            model_name='databasemetric',
            index=models.Index(fields=['database', 'created_at'], name='services_da_databas_356dd2_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='databasecredential',
            unique_together={('database', 'username')},
        ),
        migrations.AddIndex(
            model_name='databasebackup',
            index=models.Index(fields=['database', 'status'], name='services_da_databas_7753f1_idx'),
        ),
    ]
